{% comment %}
Product template
{% endcomment %}

<div class="product-container bg-black text-white">
  <div class="w-full mx-auto px-4 sm:px-6 lg:px-8 py-20">
    <div class="max-w-7xl mx-auto">
      
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-16">
        
        <!-- Product Images -->
        <div class="space-y-4">
          <div class="aspect-square overflow-hidden rounded-2xl bg-gray-800">
            {% if product.featured_image %}
              <img 
                src="{{ product.featured_image | image_url: width: 800 }}" 
                alt="{{ product.featured_image.alt | escape }}"
                class="w-full h-full object-cover"
              >
            {% else %}
              <div class="w-full h-full flex items-center justify-center text-gray-400">
                <svg class="w-24 h-24" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"/>
                </svg>
              </div>
            {% endif %}
          </div>
          
          <!-- Thumbnail gallery -->
          {% if product.images.size > 1 %}
            <div class="grid grid-cols-4 gap-4">
              {% for image in product.images limit: 4 %}
                <div class="aspect-square overflow-hidden rounded-lg bg-gray-800 cursor-pointer hover:opacity-75 transition-opacity">
                  <img 
                    src="{{ image | image_url: width: 200 }}" 
                    alt="{{ image.alt | escape }}"
                    class="w-full h-full object-cover"
                  >
                </div>
              {% endfor %}
            </div>
          {% endif %}
        </div>

        <!-- Product Info -->
        <div class="space-y-8">
          
          <!-- Breadcrumb -->
          <nav class="flex items-center space-x-2 text-sm text-gray-400">
            <a href="{{ routes.root_url }}" class="hover:text-white transition-colors">Home</a>
            <span>/</span>
            {% if collection %}
              <a href="{{ collection.url }}" class="hover:text-white transition-colors">{{ collection.title }}</a>
              <span>/</span>
            {% endif %}
            <span class="text-white">{{ product.title }}</span>
          </nav>

          <!-- Product Title -->
          <h1 class="font-montserrat font-bold text-white text-3xl md:text-4xl">
            {{ product.title }}
          </h1>

          <!-- Price -->
          <div class="flex items-center space-x-4">
            <span class="text-3xl font-bold text-green-400 font-montserrat">
              {{ product.price | money }}
            </span>
            {% if product.compare_at_price > product.price %}
              <span class="text-xl text-gray-400 line-through font-montserrat">
                {{ product.compare_at_price | money }}
              </span>
              <span class="bg-red-500 text-white px-3 py-1 rounded-full text-sm font-montserrat font-bold">
                SAVE {{ product.compare_at_price | minus: product.price | money }}
              </span>
            {% endif %}
          </div>

          <!-- Product Description -->
          {% if product.description != blank %}
            <div class="prose prose-invert max-w-none">
              <div class="font-montserrat text-gray-300 leading-relaxed">
                {{ product.description }}
              </div>
            </div>
          {% endif %}

          <!-- Product Form -->
          <form action="/cart/add" method="post" enctype="multipart/form-data" class="space-y-6">
            
            <!-- Variants -->
            {% unless product.has_only_default_variant %}
              {% for option in product.options_with_values %}
                <div class="space-y-3">
                  <label class="block text-white font-montserrat font-medium">
                    {{ option.name }}
                  </label>
                  <div class="flex flex-wrap gap-3">
                    {% for value in option.values %}
                      <input type="radio" 
                             id="{{ option.name }}-{{ value | handle }}" 
                             name="options[{{ option.name }}]" 
                             value="{{ value | escape }}"
                             {% if option.selected_value == value %}checked{% endif %}
                             class="sr-only">
                      <label for="{{ option.name }}-{{ value | handle }}" 
                             class="px-4 py-2 border border-white/20 rounded-lg cursor-pointer hover:border-green-400 transition-colors font-montserrat">
                        {{ value }}
                      </label>
                    {% endfor %}
                  </div>
                </div>
              {% endfor %}
            {% endunless %}

            <!-- Quantity -->
            <div class="space-y-3">
              <label for="quantity" class="block text-white font-montserrat font-medium">
                Quantity
              </label>
              <div class="flex items-center space-x-4">
                <button type="button" class="w-10 h-10 bg-gray-800 hover:bg-gray-700 rounded-lg flex items-center justify-center text-white transition-colors" onclick="changeQuantity(-1)">
                  -
                </button>
                <input type="number" 
                       id="quantity" 
                       name="quantity" 
                       value="1" 
                       min="1" 
                       class="w-20 text-center bg-gray-800 border border-white/20 rounded-lg py-2 text-white font-montserrat">
                <button type="button" class="w-10 h-10 bg-gray-800 hover:bg-gray-700 rounded-lg flex items-center justify-center text-white transition-colors" onclick="changeQuantity(1)">
                  +
                </button>
              </div>
            </div>

            <!-- Add to Cart -->
            <input type="hidden" name="id" value="{{ product.selected_or_first_available_variant.id }}">
            
            <button type="submit" 
                    class="w-full bg-gradient-to-r from-green-500 to-green-400 hover:from-green-600 hover:to-green-500 text-white font-montserrat font-bold py-4 px-8 rounded-full shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105 add-to-cart-btn"
                    {% unless product.available %}disabled{% endunless %}>
              {% if product.available %}
                ADD TO CART - {{ product.selected_or_first_available_variant.price | money }}
              {% else %}
                SOLD OUT
              {% endif %}
            </button>
          </form>

          <!-- Product Features -->
          {% if product.metafields.custom.features %}
            <div class="space-y-4">
              <h3 class="text-xl font-bold text-white font-montserrat">Features</h3>
              <ul class="space-y-2">
                {% for feature in product.metafields.custom.features.value %}
                  <li class="flex items-center space-x-3">
                    <svg class="w-5 h-5 text-green-400 flex-shrink-0" fill="currentColor" viewBox="0 0 24 24">
                      <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                    </svg>
                    <span class="text-gray-300 font-montserrat">{{ feature }}</span>
                  </li>
                {% endfor %}
              </ul>
            </div>
          {% endif %}

          <!-- Shipping Info -->
          <div class="bg-gray-800/50 rounded-2xl p-6 space-y-4">
            <h4 class="text-lg font-bold text-white font-montserrat">Shipping & Returns</h4>
            <div class="space-y-3 text-sm text-gray-300">
              <div class="flex items-center space-x-3">
                <svg class="w-5 h-5 text-green-400" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2 2v-2z"/>
                </svg>
                <span>Free shipping on orders over $100</span>
              </div>
              <div class="flex items-center space-x-3">
                <svg class="w-5 h-5 text-green-400" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                </svg>
                <span>30-day return policy</span>
              </div>
              <div class="flex items-center space-x-3">
                <svg class="w-5 h-5 text-green-400" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M12,1L3,5V11C3,16.55 6.84,21.74 12,23C17.16,21.74 21,16.55 21,11V5L12,1Z"/>
                </svg>
                <span>1-year warranty included</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Related Products -->
{% if collections['related-products'] and collections['related-products'].products.size > 0 %}
  <section class="py-20 bg-gray-900">
    <div class="w-full mx-auto px-4 sm:px-6 lg:px-8">
      <div class="max-w-7xl mx-auto">
        <h2 class="text-3xl font-bold text-white font-montserrat text-center mb-12">
          Related Products
        </h2>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
          {% for related_product in collections['related-products'].products limit: 4 %}
            <div class="card-gradient rounded-2xl overflow-hidden card-hover">
              <a href="{{ related_product.url }}">
                <div class="aspect-square overflow-hidden">
                  {% if related_product.featured_image %}
                    <img 
                      src="{{ related_product.featured_image | image_url: width: 400 }}" 
                      alt="{{ related_product.title }}"
                      class="w-full h-full object-cover"
                    >
                  {% endif %}
                </div>
                <div class="p-6">
                  <h3 class="font-montserrat font-bold text-white text-lg mb-2">
                    {{ related_product.title }}
                  </h3>
                  <p class="text-green-400 font-montserrat font-bold text-xl">
                    {{ related_product.price | money }}
                  </p>
                </div>
              </a>
            </div>
          {% endfor %}
        </div>
      </div>
    </div>
  </section>
{% endif %}

<script>
function changeQuantity(change) {
  const quantityInput = document.getElementById('quantity');
  const currentValue = parseInt(quantityInput.value);
  const newValue = Math.max(1, currentValue + change);
  quantityInput.value = newValue;
}

// Update variant selection
document.querySelectorAll('input[type="radio"]').forEach(radio => {
  radio.addEventListener('change', function() {
    // Update variant selection logic here
    // This would typically update the product form with the selected variant
  });
});
</script>